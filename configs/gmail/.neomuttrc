set mbox_type = Maildir
set folder = "~/.mail/gmail"

set spool_file = "+INBOX"
set postponed = "+[Gmail]/Drafts"
set record = "+[Gmail]/Sent Mail"

set quit = ask-no
set use_threads = no

# Spellcheck
set ispell = "aspell --mode=email check"
# macro compose i "<ispell>" "Run Aspell"

# We're on a totally offline setup, so it's fine
set mail_check = 300

mailboxes `find ~/.mail/gmail -type d -name cur -print0 | xargs -0 -n1 dirname | sed 's/.*/"&"/' | tr '\n' ' '`

# --- Sidebar Settings ---
set sidebar_visible = yes
set sidebar_width = 20
set sidebar_short_path = yes
set sidebar_folder_indent = yes

# Highlight the active folder in the sidebar
color sidebar_indicator brightcyan default
color sidebar_new brightyellow default

# Keybindings to move through the sidebar
# ']' to go to the next folder and open it immediately
macro index . "<sidebar-next><sidebar-open>" "Next folder"
macro pager . "<sidebar-next><sidebar-open>" "Next folder"
# '[' to go to the previous folder and open it immediately
macro index , "<sidebar-prev><sidebar-open>" "Previous folder"
macro pager , "<sidebar-prev><sidebar-open>" "Previous folder"

# --- Addressing & Contacts ---
set query_command = "abook --mutt-query '%s'"
set query_format = "%4c %t %-25.25n %-25.25a %e"
bind editor <Tab> complete-query
bind editor ^T complete
set alias_file = "~/.neomutt_aliases"   # Where NeoMutt saves manual 'A' additions
source $alias_file                      # Tells NeoMutt to actually read that file

# --- Identity Settings ---
set realname = "YOURNAMEHERE"
set from = "YOURGMAILEMAILHERE"
set use_from = yes
set envelope_from = yes
alternates "YOURGMAILEMAILHERE"

set me_too = yes
set preferred_languages="bg,en,fr,ru"
set include = yes

set empty_subject = "Re: "
set greeting = "Hi %v,"

# Signature settings
set signature = "~/.neomutt_signature"
set sig_on_top = yes

# Forwarding
set forward_format = "Fwd: %s"
set forward_quote = yes
# set forward_attribution_intro = ""
# set forward_attribution_trailer = ""

# Force NeoMutt to use the queue script
set sendmail = "~/bin/msmtp-enqueue-only"

# Tell NeoMutt NOT to wait for the result (helps with backgrounding)
set sendmail_wait = -1

# This prevents NeoMutt from trying to be 'smart' and using its internal SMTP
set write_bcc = yes

# Set the global default
set sort = reverse-date
set sort_aux = date

# Date & Index Definitions
set date_format = "%Y-%m-%d %H:%M"

# Update the hooks to enforce REVERSE sorting every time you switch folders
# Note the 'reverse-date' inside the single quotes
folder-hook . 'set sort=reverse-date; set index_format="%4C %Z %d %-25.25n %s"'
# folder-hook . 'set sort=date; set sort_aux=reverse-date; set index_format="%4C %Z %d %-25.25n %s"'

# Handle the Sent folder (also newest on top)
folder-hook "[Gmail]/Sent Mail" 'set sort=reverse-date; set index_format="%4C %Z %d %-25.25t %s"'

# Colors
color index brightyellow default "~N"
color index cyan default "~F"           # Flagged (Starred)
color index brightred default "~D"      # Flagged for deletion
color index brightwhite default "~O"    # Old, but still unread
color index_date green default          # The date column
color index_subject white default       # The subject

# Quotes (text starting with >)
color body cyan default "^>.*"
color body brightcyan default "^>>.*"
color body blue default "^>>>.*"

# Pager colors
color header white default "."
color header green default "Date:"
color header green default "Received:"
color header brightwhite default "From:"
color header brightwhite default "Reply-To:"
color header cyan default "To:"
color header brightwhite default "Delivered-To:"
color header brightyellow default "Subject:"

